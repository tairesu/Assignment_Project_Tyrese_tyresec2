{% extends 'cardManager/base.html'%}
{% block title %}
	Dashboard
{% endblock %}
{% block opener %}
	User: {{ request.user }}
{% endblock %}
{% block content %}
{% if request.user.is_superuser %}
	<h2 class="text-xl mb-2">Pending Orders</h2>
	<div class="w-full grid grid-cols-1 gap-4 mb-20 md:grid-cols-3">
		{% for order in pending_orders %}
			<div class="flex flex-row items-center gap-4 rounded-sm p-4 card-order">
				<img class="mini-card rounded-sm" src="
				{% if order.custom_design %}
					{{ order.custom_design.url }}
				{% elif order.preset_design %}
					{{ order.preset_design.front_design.url }} 
				{% endif %}"/>
				<div>
					<p class="font-bold">{{ order.owner }}</p>
					<a href="{{ order.get_absolute_url }}" class="text-(--color-main)">View</a>
				</div>
			</div>
			{% empty %}
			<p>Looks like there aren't any orders yet.</p>
		{% endfor %}
	</div>
{% endif %}
	<h2 class="text-xl mb-6">My Cards</h2>
	<div id="user-cards" class="flex flex-wrap flex-col gap-6 mb-20 md:m-auto md:grid md:grid-cols-[1fr_1fr_1fr] md:gap-4">
	{% for card in user_cards %}
		<div class="flex flex-row items-center gap-4 ">
			<a href="{{ card.get_update_url }}" class=" md-card can-expand rounded-sm w-full h-full bg-[url('{{ card.design.front_design.url }}')]">
			</a>
			<div class="md:hidden">
				{% if card.alias %}
					<p class="font-bold text-lg">{{ card.alias }}</p>
					{% else %}
					<p class="font-bold text-lg">{{ card }}</p>
				{% endif %}
				{% if card.show_profile %}
					<p class="text-darkgrey">Points to your profile</p>
				{% elif not card.show_profile and card.reroute_url %}
					<p class="text-darkgrey">{{ card.reroute_url }}</p>
				{% else %}
				{% endif %}
				<a href="{{ card.get_update_url }}" class="text-(--color-main)">Edit</a>
			</div>
		</div>
		{% empty %}
		<p>Looks like there aren't any cards here.</p>
	{% endfor %}
	
	</div>
	<h2 class="text-xl mb-6 md:mt-20">Arriving Soon</h2>
	<div class="flex flex-row w-full overflow-x-auto gap-6 mb-20">
	{% for card_request in requested_cards %}
		<div class="text-nowrap flex flex-col items-center gap-4 opacity-[0.3] ">
				<img 
					class="md-card rounded-sm" 
					src="
					
					{% if card_request.custom_design %}
						{{ card_request.custom_design.url }}
					{% elif card_request.preset_design %}
						{{ card_request.preset_design.front_design.url }} 
					{% endif %}"/>
			
			<div>
			<p class="font-bold">On it's way</p>
			<p class=" text-sm text-[var(--color-grey)]">Ordered: {{ card_request.date_created|date:"m/j/y"}}</p>
			</div>
			
		</div>
		{% endfor %}
	
	</div>
		<div class="activity flex flex-col">
			<h2 class="text-xl">Recent Activity</h2>
			{% for activity in recent_activities%}
			<div class="flex flex-row items-center gap-2">
				<div>
					<img src="{{ activity.card.design.front_design.url }}" class="w-[3rem] h-[1.7rem] rounded-sm">
				</div>
				<div class="flex flex-col mt-2">
					{% if activity.card.alias %}
					<p>{{ activity.card.alias }} was tapped</p>
					{% else %}
					<p>{{ activity.card }} was tapped</p>
				{% endif %}
					<p class="text-xs">{{ activity.date_used|date:"h:i a m/j/y" }} </p>
				</div>
			</div>
			{% empty %}
				<p>No recent activity yet</p>
			{% endfor %}
		</div>
	
{% endblock %}