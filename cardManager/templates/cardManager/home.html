{% extends 'cardManager/base.html' %}
{% load static  %}
{% block title %}
	TC Digital | Digital Cards 
{% endblock %}
{% block hero_text %} The only business card you'll need  {% endblock %}
{% block content %}
    <section id="features" class="mb-40 hidden">
        <h2 class="text-2xl mb-10">
            Features
        </h2>
        <div class="w-full flex flex-row overflow-x-auto gap-4">
           <div class="feature w-60 bg-white rounded-md  lg:w-30">
            <div class="icon-and-head flex flex-row"></div>
            <img src="" alt="">
            <h2 class="text-xl text-black">Infinite Taps</h2>
            <div>
                <p class="text-md text-grey"></p>
            </div>
           </div>
           <div class="feature w-60 bg-white rounded-md  lg:w-30">
            <div class="icon-and-head flex flex-row"></div>
            <img src="" alt="">
            <h2 class="text-xl text-black">QR Included</h2>
            <div>
                <p class="text-md text-grey"></p>
            </div>
           </div>
           <div class="feature w-60 bg-white rounded-md  lg:w-30">
            <div class="icon-and-head flex flex-row"></div>
            <img src="" alt="">
            <h2 class="text-xl text-black">Taps</h2>
            <div>
                <p class="text-md text-grey"></p>
            </div>
           </div>
        </div>
    </section>
    <section id="design" class="flex flex-col items-center my-12 w-full m-auto gap-12">
        
        <div class=" flex w-max items-center justify-center relative">
            <img id="card" class="object-cover rounded-md h-[11rem] w-[18rem]" src="{{ design_list.first.front_design.url}}"/>
            <div class="w-full h-full absolute top-0 left-0" style="background:var(--color-reflective)"></div>
        </div>
        <div class="design_toggle">

        </div>
        <h2 class="mb-5 hidden">
            Choose a Preset Design
        </h2>
        <div class="w-full overflow-x-auto md:flex md:justify-center md:items-center ">
            <div class="flex flex-row md:grid md:grid-cols-[1fr_1fr_1fr_1fr] gap-2 md:gap-4 w-max">
                {% for design in design_list %}
                    <button onclick="setDesignChoice(this)" >
                        <img src="{{ design.front_design.url }}" data-id="{{ design.pk }}" class="w-[6rem] h-[3.5rem] object-cover rounded-md" />
                    </button>
                {% endfor %}
                <button onclick="showUploadFile()" >
                    <p class="w-[6rem] h-[3.5rem] object-cover rounded-md flex justify-center text-5xl" style="border: 2px dashed var(--color-input-border);">
                        <svg xmlns="http://www.w3.org/2000/svg" style="fill:var(--color-input-border);width:2rem;height:3rem" viewBox="0 0 640 640"><!--!Font Awesome Free v7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M304 112L192 112C183.2 112 176 119.2 176 128L176 512C176 520.8 183.2 528 192 528L448 528C456.8 528 464 520.8 464 512L464 272L376 272C336.2 272 304 239.8 304 200L304 112zM444.1 224L352 131.9L352 200C352 213.3 362.7 224 376 224L444.1 224zM128 128C128 92.7 156.7 64 192 64L325.5 64C342.5 64 358.8 70.7 370.8 82.7L493.3 205.3C505.3 217.3 512 233.6 512 250.6L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 128zM387.4 496L252.6 496C236.8 496 224 483.2 224 467.4C224 461 226.1 454.9 230 449.8L297.6 362.9C303 356 311.3 352 320 352C328.7 352 337 356 342.4 362.9L410 449.9C413.9 454.9 416 461.1 416 467.5C416 483.3 403.2 496.1 387.4 496.1zM240 288C257.7 288 272 302.3 272 320C272 337.7 257.7 352 240 352C222.3 352 208 337.7 208 320C208 302.3 222.3 288 240 288z"/></svg>
                    </p>
                </button>
            </div>
        </div>
        <form action="{% url 'order_card_view' %}" class="mt-6 flex flex-col gap-12 w-3/4" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div id="uploadFile" class="flex flex-col gap-6 hidden">
                <h2 class="text-center mb-6">
                    Upload your own design
                </h2>
                <div class="w-full ">
                    {% if request.session.order_post %}
                        {{ form.custom_design }}
                    {% else %}
                    <input type="file" class="w-full bg-[var(--color-input-bkg)] border-solid border-[1px] border-[var(--color-input-border)] rounded-md p-4" placeholder="Upload a file" id="id_custom_design" name="custom_design">
            
                    {% endif %}
                </div>
            </div>
            <div class="w-full  hidden">
                <h2 class="mb-5">
                    How many do you need?
                </h2>
                {% if request.session.order_post %}
                    {{ form.card_qty }}
                {% else %}
                <input type="number" value="1" class="bg-[var(--color-input-bkg)] border-solid border-[1px] border-[var(--color-input-border)] rounded-md p-4" min="1" max="500" id="id_card_qty" name="card_qty">
                {% endif %}
        
            </div>
            <input 
                type="hidden" 
                name="owner" 
                value="{% if request.user %} {{ request.user.pk }} {%endif%}"
            />
            <input 
                type="hidden" 
                name="preset_design" 
                id="design_choice" 
                {% if request.session.order_post %}
                value="{{ form.data.preset_design }}"
                {% else %}
                value="1"{% endif %}

            />
            <button class="bg-[var(--color-main)] w-full text-center py-4 rounded-md " id="order-btn" type="submit">
                Order Card
            </button>

        </form>
    </section>
    
{% endblock %}
{% block extra_scripts %}
<script src="{% static 'js/updateDesign.js' %}?v={{ tz }}"></script>

{% if request.session.order_post and request.user.is_authenticated %}
    <script type="text/javascript">
        let design_id = document.querySelector('#design_choice').value;
        preselectDesignChoice(design_id)
    </script>
{% endif %}
{% endblock %}